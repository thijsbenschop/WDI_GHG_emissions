---
title: "GHG emissions sources and indicators"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
setwd("C:/Users/wb460271/OneDrive - WBG/Documents/GitHub/WDI_GHG_emissions")
```

## Overview of indicators included in WDI

The following GHG related indicators are currently in the WDI database:

Environment: Emissions section

| Series code           | Description                                         | Source    | Time coverage |
| --------------------- | --------------------------------------------------- | --------- | ------------- |
| EN.ATM.GHGT.KT.CE	    | Total greenhouse gas emissions (thousand metric tons of CO2 equivalent excluding Land-Use Change and Forestry) | CDIAC / CAIT| 1970-2018|
| EN.ATM.GHGT.ZG	      | Total greenhouse gas emissions (% change from 1990) | EDGAR (EC JRC/PBL)    | 1991-2012
| EN.ATM.CO2E.KT	      | Total CO2 emissions (thousand metric tons of CO2 excluding Land-Use Change and Forestry) | CDIAC / CAIT| 1960-2018|
| EN.ATM.CO2E.GF.KT	    | CO2 emissions from gaseous fuel consumption (kt) | CDIAC | 1960-2016|
| EN.ATM.CO2E.GF.ZS	    | CO2 emissions from gaseous fuel consumption (% of total) | CDIAC | 1960-2016|
| EN.ATM.CO2E.LF.KT	    | CO2 emissions from liquid fuel consumption (kt) | CDIAC | 1960-2016|
| EN.ATM.CO2E.LF.ZS	    | CO2 emissions from liquid fuel consumption (% of total) | CDIAC | 1960-2016|
| EN.ATM.CO2E.SF.KT	    | CO2 emissions from solid fuel consumption (kt) | CDIAC | 1960-2016|
| EN.ATM.CO2E.SF.ZS	    | CO2 emissions from solid fuel consumption (% of total) | CDIAC | 1960-2016|
| EN.ATM.CO2E.EG.ZS	    | CO2 intensity (kg per kg of oil equivalent energy use) | CDIAC | 1990-2015
| EN.ATM.CO2E.PC	      | CO2 emissions (metric tons per capita) | CDIAC / CAIT| 1960-2018
| EN.ATM.CO2E.KD.GD	    | CO2 emissions (kg per 2010 US$ of GDP) | CDIAC / CAIT| 1960-2018
| EN.ATM.CO2E.PP.GD.KD	| CO2 emissions (kg per 2017 PPP $ of GDP) | CDIAC / CAIT (?)| 1990-2018
| EN.ATM.CO2E.PP.GD	    | CO2 emissions (kg per PPP $ of GDP) | CDIAC / CAIT (?)| 1990-2018
| EN.ATM.METH.AG.KT.CE	| Agricultural methane emissions (thousand metric tons of CO2 equivalent) | CDIAC / CAIT | 1969-2018
| EN.ATM.METH.AG.ZS	    | Agricultural methane emissions (% of total) | EDGAR (EC JRC/PBL) | 1970-2008
| EN.ATM.METH.EG.KT.CE	| Methane emissions in energy sector (thousand metric tons of CO2 equivalent) | CDIAC / CAIT | 1969-2018
| EN.ATM.METH.EG.ZS	    | Energy related methane emissions (% of total) | EDGAR (EC JRC/PBL) | 1970-2008
| EN.ATM.METH.KT.CE     | Total methane emissions (thousand metric tons of CO2 equivalent excluding Land-Use Change and Forestry) | CDIAC / CAIT | 1970-2018
| EN.ATM.METH.ZG	      | Methane emissions (% change from 1990) | EDGAR (EC JRC/PBL) | 1991-2012
| EN.ATM.NOXE.AG.KT.CE	| Agricultural nitrous oxide emissions (thousand metric tons of CO2 equivalent)  | CDIAC / CAIT | 1969-2018
| EN.ATM.NOXE.AG.ZS	    | Agricultural nitrous oxide emissions (% of total) | EDGAR (EC JRC/PBL) | 1970-2008
| EN.ATM.NOXE.EG.KT.CE	| Nitrous oxide emissions in energy sector (thousand metric tons of CO2 equivalent) | CDIAC / CAIT | 1969-2018
| EN.ATM.NOXE.EG.ZS	    | Nitrous oxide emissions in energy sector (% of total) | EDGAR (EC JRC/PBL) | 1970-2008
| EN.ATM.NOXE.KT.CE	    | Total nitrous oxide emissions (thousand metric tons of CO2 equivalent excluding Land-Use Change and Forestry) | CDIAC / CAIT | 1970-2018
| EN.ATM.NOXE.ZG	      | Nitrous oxide emissions (% change from 1990) | EDGAR (EC JRC/PBL) | 1991-2012
| EN.ATM.HFCG.KT.CE	    | HFC gas emissions (thousand metric tons of CO2 equivalent) | EDGAR (EC JRC/PBL) | 1990-2010 (not annual)
| EN.ATM.PFCG.KT.CE	    | PFC gas emissions (thousand metric tons of CO2 equivalent) | EDGAR (EC JRC/PBL) | 1990-2010 (not annual)
| EN.ATM.SF6G.KT.CE	    | SF6 gas emissions (thousand metric tons of CO2 equivalent) | EDGAR (EC JRC/PBL) | 1990-2010 (not annual)
| EN.ATM.GHGO.KT.CE	    | Other greenhouse gas emissions, HFC, PFC and SF6 (thousand metric tons of CO2 equivalent)  | EDGAR (EC JRC/PBL) | 1970-2016 (not annual)
| EN.ATM.GHGO.ZG        | Other greenhouse gas emissions (% change from 1990) | EDGAR (EC JRC/PBL) | 1991-2012

<!-- | EN.ATM.PM25.MC.M3	    | PM2.5 air pollution, mean annual exposure (micrograms per cubic meter) | -->
<!-- | EN.ATM.PM25.MC.T1.ZS	| PM2.5 pollution, population exposed to levels exceeding WHO Interim Target-1 value (% of total) | -->
<!-- | EN.ATM.PM25.MC.T2.ZS	| PM2.5 pollution, population exposed to levels exceeding WHO Interim Target-2 value (% of total) | -->
<!-- | EN.ATM.PM25.MC.T3.ZS	| PM2.5 pollution, population exposed to levels exceeding WHO Interim Target-3 value (% of total) | -->
<!-- | EN.ATM.PM25.MC.ZS	    | PM2.5 air pollution, population exposed to levels exceeding WHO guideline value (% of total) | -->

Other sections

| Series code           | Description                                     | Source                        | Time coverage |
| --------------------- | ----------------------------------------------- | ----------------------------- | ------------- |
| EN.CLC.GHGR.MT.CE	    | GHG net emissions/removals by LUCF (MtCO2e)     | UNFCCC                        | 1990 - 2009   |
<!-- | EN.CLC.ICER	          | Issued Certified Emission Reductions (CERs) from CDM (thousands) || -->
<!-- | EN.CLC.IERU	          | Issued Emission Reduction Units (ERUs) from JI (thousands) || -->
<!-- | EN.CLC.NCOM	          | Latest UNFCCC national communication            || -->

<!-- EN.ATM.CO2E.KT - Carbon dioxide emissions are those stemming from the burning of fossil fuels and the manufacture of cement. They include carbon dioxide produced during consumption of solid, liquid, and gas fuels and gas flaring.  -->
 
## Definitions
### Kyoto basket greenhouse gases

| Code   | Description                                     |
| ------ | ------------------------------------------------ |
| CO2 | Carbon Dioxide |
| CH4 | Methane |
| FGASES | Fluorinated Gases (Hydrofluorocarbons + Perflurocarbons) |
| N2O | Nitrous Oxide |
| SF6 | Sulfur Hexafluoride |

Global warming potentials : SAR / AR4 - e.g. Methane 21 vs. 25

### Category codes

Category descriptions using IPCC 1996 terminology.

| Code   | Description                                     |
| ------ | ------------------------------------------------ |
| 0      | National Total                                   |
| M.0.EL | National Total, excluding LULUCF                 |
| 1      | Total Energy                                     |
| 1.A    | Fuel Combustion Activities                       |
| 1.B    | Fugitive Emissions from Fuels                    |
| 2      | Industrial Processes                             |
| 3      | Solvent and Other Product Use                    |
| 4      | Agriculture                                      |
| 5      | Land Use, Land Use Change, and Forestry (LULUCF) |
| 6      | Waste                                            |
| 7      | Other                                            |

## Data sources
* CDIAC - Carbon Dioxide Information analysis Center
  + CO2 emissions from fossil-fuel burning, cement production, and gas flaring
  + *URL* https://cdiac.ess-dive.lbl.gov/trends/emis/meth_reg.html
  + *Time coverage*: data from 1751 until 2014
  + *Countries*: ~180 (1960-1990), ~215 (1991-2014)
  + *License*: https://cdiac.ess-dive.lbl.gov/permission.html
* CAIT - Climate Analysis Indicators Tool (Climate Watch / World Resources Institute): 
  + all sectors and gases
  + *URL* https://www.climatewatchdata.org/ghg-emissions?end_year=2018&start_year=1990 
  + *Time coverage*: data from 1990-2018
  + *Countries*: 197 countries (parties to UNFCCC)
  + *License*: 
* PIK PRIMAP - Potsdam Institute for Climate Impact Research
  + All Kyoto GHGs by country, year and category
  + *URL* https://www.pik-potsdam.de/paris-reality-check/primap-hist/, https://dataservices.gfz-potsdam.de/pik/showshort.php?id=escidoc:4736895
  + *Time coverage*: data from 1850-2018 (check https://zenodo.org/record/4479172#.YV765ZpNeUk published in January 2021)
  + *Countries*: 216 countries
  + *License*: CC BY 4.0
* GCP - Global Carbon Project: https://www.icos-cp.eu/science-and-impact/global-carbon-budget/2018
  + CO2 emissions from fossil fuel combustion, cement production, and bunkers.
  + *URL* https://www.icos-cp.eu/science-and-impact/global-carbon-budget/2018
  + *Time coverage*: data from 1960-2018 
  + *Countries*: 229 countries and regions
  + *License*: 
* IEA - International Energy Agency: 
  + *URL* https://cdiac.ess-dive.lbl.gov/trends/emis/meth_reg.html
  + *Time coverage*: data from 1971-2018 (until 2019 for OECD countries)
  + *Countries*: OECD countries, total 145 countries
  + *License*: 
  
### Data uncertainty
According to the Working Group III Contribution to the IPCC Fifth Assessment Report, global CO2 emissions from fossil fuel combustion are known within *8%* uncertainty (90% confidence interval). CO2 emissions from FOLU (forestry and other land use) have very large uncertainties associated with them in the order of *± 50%*. Uncertainty for global emissions of CH4, N2O and the F-gases has been estimated as *20%*, *60%* and *20%* respectively. For the PIK dataset, regional deforestation emissions are downscaled to the country level using estimates of the deforested area obtained from potential vegetation and calculations for the needed agricultural land. Accordingly levels of uncertainty are quite high for earlier years of data (closer to 1850).

## Proposal for WDI GHG emissions indicators
Source PIK 

| Series code           | Description           |
| --------------------- | --------------------- |
|

List of indicators:
* Emissions by type in CO2e (CO2, methane, nitrous oxide, fluorinated gases (SF6) + total)
* Emissions by sector/categories – use IPCC 1996 categories 
* Change from base year 1990 (own computation)
* Per capita emissions (only total?) (own computation)
* Carbon intensity of economy (CO2e / GDP) (own computation)


* Concentration in atmosphere
* Pathways 


### Plotting data
Plotting data from different sources for CO2 emissions
```{r plot_WLD, echo=FALSE, warning= FALSE}
combined_sources <- readRDS("Data/data_for_plots/combined_sources.rds")

ggplot(data=combined_sources %>% filter(Year >= 1960), aes(Year)) +
  geom_line(aes(y = WORLD_CAIT, colour = "CAIT"), size = 1)+
  geom_line(aes(y = WORLD_CDIAC, colour = "CDIAC"), size = 1)+
  geom_line(aes(y = WORLD_WDI, colour = "WDI"), size = 1) +
  geom_line(aes(y = CAT0/1000, colour = "PIK CAT0"), size = 1) +
  geom_line(aes(y = WORLD_PIK_1, colour = "PIK CAT0 - CAT5"), size = 1) +
  geom_line(aes(y = WORLD_PIK_2, colour = "PIK CAT0 - CAT5 - CAT6 - CAT7"), size = 1) +
  geom_line(aes(y = (CAT1 + CAT2)/1000, colour = "PIK CAT1 + CAT2"), size = 1) +
  labs(x = "Year", y= "CO2 emissions (ktCO2)", title = "World", subtitle = "1960-latest datapoint")

ggplot(data=combined_sources %>% filter(Year >= 1980 & Year <= 2000), aes(Year)) +
  geom_line(aes(y = WORLD_CAIT, colour = "CAIT"), size = 1)+
  geom_line(aes(y = WORLD_CDIAC, colour = "CDIAC"), size = 1)+
  geom_line(aes(y = WORLD_WDI, colour = "WDI"), size = 1) +
  geom_line(aes(y = CAT0/1000, colour = "PIK CAT0"), size = 1) +
  geom_line(aes(y = WORLD_PIK_1, colour = "PIK CAT0 - CAT5"), size = 1) +
  geom_line(aes(y = WORLD_PIK_2, colour = "PIK CAT0 - CAT5 - CAT6 - CAT7"), size = 1) +
  geom_line(aes(y = (CAT1 + CAT2)/1000, colour = "PIK CAT1 + CAT2"), size = 1) +
  labs(x = "Year", y= "CO2 emissions (ktCO2)", title = "World", subtitle = "1980-2000")
```


```{r plot_CHN, echo=FALSE, warning= FALSE}
combined_sources_CHN <- readRDS("Data/data_for_plots/combined_sources_CHN.rds")

## China
ggplot(data=combined_sources_CHN %>% filter(Year >= 1960), aes(Year)) +
  geom_line(aes(y = CDIAC_CHN, colour = "CDIAC - CHN"), size = 1)+
  geom_line(aes(y = WDI_CHN, colour = "WDI - CHN"), size = 1) +
  geom_line(aes(y = CAIT_CHN, colour = "CAIT"), size = 1) +
  geom_line(aes(y = IEA_CHN, colour = "IEA"), size = 1) +
  geom_line(aes(y = CAT0/1000, colour = "PIK - CAT0"), size = 1) +
  geom_line(aes(y = CHN_PIK, colour = "PIK - CATM.0.EL"), size = 1) +
  geom_line(aes(y = (CAT1 + CAT2)/1000, colour = "PIK - CAT1 + CAT2"), size = 1) +
  labs(x = "Year", y= "CO2 emissions (ktCO2)", title = "China", subtitle = "1960-latest datapoint")

ggplot(data=combined_sources_CHN %>% filter(Year >= 1980 & Year <= 2000), aes(Year)) +
  ggtitle("China 1980-2000") +
  geom_line(aes(y = CDIAC_CHN , colour = "CDIAC - CHN"), size = 1.2)+
  geom_line(aes(y = WDI_CHN , colour = "WDI - CHN"), size = 1.2) +
  geom_line(aes(y = CAIT_CHN, colour = "CAIT"), size = 1.2) +
  geom_line(aes(y = IEA_CHN, colour = "IEA"), size = 1.2) +
  geom_line(aes(y = CAT0/1000, colour = "PIK - CAT0"), size = 1.2) +
  geom_line(aes(y = CHN_PIK, colour = "PIK - CATM.0.EL"), size = 1.2) +
  geom_line(aes(y = (CAT1 + CAT2)/1000, colour = "PIK - CAT1 + CAT2"), size = 1.2) +
  labs(x = "Year", y= "CO2 emissions (ktCO2)", title = "China", subtitle = "1980-2000")
```


```{r plot_USA, echo=FALSE, warning= FALSE}
combined_sources_USA <- readRDS("Data/data_for_plots/combined_sources_USA.rds")
ggplot(data=combined_sources_USA %>% filter(Year >= 1960), aes(Year)) +
  geom_line(aes(y = CDIAC_USA , colour = "CDIAC - USA"), size = 1)+
  geom_line(aes(y = WDI_USA , colour = "WDI - USA"), size = 1) +
  geom_line(aes(y = CAIT_USA, colour = "CAIT"), size = 1) +
  geom_line(aes(y = IEA_USA, colour = "IEA"), size = 1) +
  geom_line(aes(y = CAT0/1000, colour = "PIK - CAT0"), size = 1) +
  geom_line(aes(y = USA_PIK, colour = "PIK - CATM.0.EL"), size = 1) +
  geom_line(aes(y = (CAT1 + CAT2)/1000, colour = "PIK - CAT1 + CAT2"), size = 1) +
  labs(x = "Year", y= "CO2 emissions (ktCO2)", title = "USA", subtitle = "1960-latest datapoint") #+

ggplot(data=combined_sources_USA %>% filter(Year >= 1980 & Year <= 2000), aes(Year)) +
  geom_line(aes(y = CDIAC_USA , colour = "CDIAC - USA"), size = 1)+
  geom_line(aes(y = WDI_USA , colour = "WDI - USA"), size = 1) +
  geom_line(aes(y = CAIT_USA, colour = "CAIT"), size = 1) +
  geom_line(aes(y = IEA_USA, colour = "IEA"), size = 1) +
  geom_line(aes(y = CAT0/1000, colour = "PIK - CAT0"), size = 1) +
  geom_line(aes(y = USA_PIK, colour = "PIK - CATM.0.EL"), size = 1) +
  geom_line(aes(y = (CAT1 + CAT2)/1000, colour = "PIK - CAT1 + CAT2"), size = 1) +
  labs(x = "Year", y= "CO2 emissions (ktCO2)", title = "USA", subtitle = "1980-2000") #+
```

How are values for the Russian Federation before 1992 computed? As share of USSR? CDIAC lists Russia only starting 1992.

```{r plot_RUS, echo=FALSE, warning= FALSE}
combined_sources_RUS <- readRDS("Data/data_for_plots/combined_sources_RUS.rds")

ggplot(data=combined_sources_RUS %>% filter(Year >= 1960), aes(Year)) +
  geom_line(aes(y = CDIAC_RUS , colour = "CDIAC - RUS"), size = 1)+
  geom_line(aes(y = WDI_RUS , colour = "WDI - RUS"), size = 1) +
  geom_line(aes(y = CAIT_RUS, colour = "CAIT"), size = 1) +
  geom_line(aes(y = IEA_RUS, colour = "IEA"), size = 1) +
  geom_line(aes(y = CAT0/1000, colour = "PIK - CAT0"), size = 1) +
  geom_line(aes(y = RUS_PIK, colour = "PIK - CAT0 - CAT5"), size = 1) +
  geom_line(aes(y = (CAT1 + CAT2)/1000, colour = "PIK - CAT1 + CAT2"), size = 1) +
  labs(x = "Year", y= "CO2 emissions (ktCO2)", title = "Russian Federation", subtitle = "1960-latest datapoint")

ggplot(data=combined_sources_RUS %>% filter(Year >= 1980 & Year <= 2000), aes(Year)) +
  geom_line(aes(y = CDIAC_RUS , colour = "CDIAC - RUS"), size = 1)+
    geom_line(aes(y = CDIAC_USSR/1000, colour = "CDIAC - USSR"), size = 1)+
  geom_line(aes(y = WDI_RUS , colour = "WDI - RUS"), size = 1) +
  geom_line(aes(y = CAIT_RUS, colour = "CAIT"), size = 1) +
  geom_line(aes(y = IEA_RUS, colour = "IEA"), size = 1) +
  geom_line(aes(y = CAT0/1000, colour = "PIK - CAT0"), size = 1) +
  geom_line(aes(y = RUS_PIK, colour = "PIK - CAT0 - CAT5"), size = 1) +
  geom_line(aes(y = (CAT1 + CAT2)/1000, colour = "PIK - CAT1 + CAT2"), size = 1) +
  labs(x = "Year", y= "CO2 emissions (ktCO2)", title = "Russian Federation", subtitle = "1980-2000")
```

### Understanding differences
* Different methodologies
* Different categories
* Different geographical boundaries

## Suggestions for GHG indicators

Choice of indicators depends on different factors:

* Data availability (country coverage/time series)
* Methodology used
* Reliability of data
* Relevance for development

## Questions

* Factors used for computation of CO2e of other GHGs -> different factors used
* Use extrapolated values for subset of countries for the years 2016-2018

## Miscellaneous 

* Add more detail to description of series (e.g., )
* Difference CAIT and PIK: CAIT doesn't use official inventories reported UNFCCC, PIK does for countries where available